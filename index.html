<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>A3</title>
    <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <style>
    .chart div {
  font: 10px sans-serif;
  background-color: white;
  text-align: left;
  padding: 3px;
  margin: 1px;
  color: white;
  width: 200px;
}
  div.caseJusticeBox {
    display: inline;
    width: 100px;
  }
    </style>
  </head>
  <body>
  
  <h1>Supreme Court Jukebox</h1>
  
  <div class="chart"></div>
    <script type="text/javascript">

var x = d3.scale.linear()
    .domain([0, 100])
    .range([0, 420]);

d3.csv("data/scd_since2000.csv", function(d) {
  return {
    caseId: d.caseId,
    decisionDate: d.dateDecision, // convert "Year" column to Date
    justiceName: d.justiceName,
    justiceID: +d.justice,
    vote: +d.direction // convert "Length" column to number
  };
}, function(error, rows) {
//  console.log(rows);
  
  var nestedByCaseId = d3.nest().key(function(d) { return d.caseId; }).entries(rows);
  //console.log(nestedByCaseId);
  
  var svgContainer = d3.select("body").append("svg")
                                     .attr("width", 900)
                                     .attr("height", 2000);
                                     
  var row = svgContainer.selectAll("g")
    .data(nestedByCaseId).enter().append("g")
    .attr("transform", function(d, i) { return "translate(0," + i * 20 + ")"; });

  row.each(function(d) {
    //console.log(d);
    for (i=0; i < d.values.length; i++) {
      var cell = d3.select(this).append("g").attr("transform", function(d) { return "translate(" + i * 100 + ",0)"; });
      
      cell.append("rect").attr("width",98).attr("height",18)
        .attr("style",function(d) { if (d.values[i].vote == 1) { return "fill:steelblue;" } else  { return "fill:darkred;"; } });
      cell.append("text").attr("x",5).attr("y",15).text(function(d) { return d.values[i].justiceName; });
    }
  });

  /*row.append("rect").attr("width",100).attr("height",20).attr("style","fill:rgb(100,100,255);");
         
  row.append("text")
    .attr("x", function(d) { return 5; })
    .attr("y", 10)
    .attr("dy", ".35em")
    .text(function(d) { return d.key; });  */    
    
                          
  /*svgContainer.selectAll("rect").data(nestedByCaseId).enter()
    .append("rect").attr("width",100).attr("height",20)
    .each(function(d) {
      //console.log(d);
      for (i = 0; i < d.values.length; i++) { 
        d3.select(this).append("div").attr("class","caseJusticeBox").text(d.values[i].justiceName)
        .style("background-color", function(d) { if (d.values[i].vote == 1) { return "steelblue"; } else { return "darkred"; } });
      }
    })
    .style("width", function(d) { return 100*d.values.length + "px"; })*/
  /*d3.select(".chart")
  .selectAll("div")
    .data(nestedByCaseId)
  .enter().append("div")
    .attr("id", function(d) { return d.key; })
    .each(function(d) {
      console.log(d);
      for (i = 0; i < d.values.length; i++) { 
        d3.select(this).append("div").attr("class","caseJusticeBox").text(d.values[i].justiceName)
        .style("background-color", function(d) { if (d.values[i].vote == 1) { return "steelblue"; } else { return "darkred"; } });
      }
    })
    .style("width", function(d) { return 100*d.values.length + "px"; })*/
});


    </script>
  </body>
</html>

